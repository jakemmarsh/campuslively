<div class="white-top">
	<div class="container full-height">
		<div class="table full-height full-width">
			<div class="td vertical-align-middle one-half">
				<h1 class="flush blue">Events Calendar</h1>
			</div>
			<div class="td vertical-align-middle one-half text-right">
				<ng-switch-toggle-group data-theme="candy" data-ng-model="currentView" data-choices="viewOptions" class="float-right"></ng-switch-toggle-group>
			</div>
		</div>
	</div>
</div>
<div class="container soft-half--ends">
	<div data-ui-calendar="calendarOptions" data-ng-model="events" data-calendar="eventCalendar" class="nudge-half--bottom"></div>
	<div data-ng-show="loadingDayEvents" class="text-center soft--ends">
		<div class="box island inline-block">
			<h1 class="flush blue">Loading events...</h1>
		</div>
	</div>
	<div data-ng-hide="dayEvents.length || loadingDayEvents || !showDay" class="text-center soft--ends">
		<h1 class="blue nudge--ends">No events have been posted for your school on {{ selectedDay | readableDate}}.</h1>
	</div>
	<div data-ng-show="showDay && dayEvents.length && !loadingDayEvents" id="dayEvents">
		<div class="table full-width">
			<div class="tr">
				<div class="td one-half vertical-align-middle">
					<h2 class="flush nudge-half--bottom">Events on {{ selectedDay | readableDate }}</h2>
				</div>
				<div class="td one-half vertical-align-middle text-right">
					<div class="dropdown">
						<a href class="dropdown-toggle">
							{{ currentSort.label }} <i class="icon-chevron-down muted weight--normal"></i>
						</a>
						<ul class="dropdown-menu pull-right" style="left:none !important;right:0;">
							<li data-ng-repeat="option in sortOptions">
								<a href data-ng-bind="option.label" data-ng-click="changeSort(option)"></a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<hr />
		<div class="line nudge--ends" data-ng-repeat="event in dayEvents | orderBy:currentSort.value">
			<div class="unit one-twelfth">
				<div class="user-img-event" data-ng-style="{'background-image': 'url(' + event.creator.pictureUrl + ')'}">
					<a href data-tooltip="{{event.creator.businessName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'business'"></a>
					<a href data-tooltip="{{event.creator.firstName}} {{event.creator.lastName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'student'"></a>
				</div>
			</div>
			<div class="unit eleven-twelfths last-unit">
				<div class="box">
					<div class="event-header soft-half--sides">
						<div class="line">
							<div class="unit one-half">
								<i class="beta icon-circle nudge-half--right float-left" data-ng-show="event.privacy == 'public'" data-tooltip="Public" data-tooltip-placement="top"></i>
								<i class="beta icon-circle-blank nudge-half--right float-left" data-ng-show="event.privacy == 'inviteonly'" data-tooltip="Invite Only" data-tooltip-placement="top"></i>
								<h2 class="flush">
									<a data-ng-href="/event/{{event._id}}">
										{{ event.title }}
									</a>
								</h2>
							</div>
							<div class="unit one-half last-unit text-right">
								Posted by
								 <a data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'student'">{{event.creator.firstName}} {{event.creator.lastName}}</a>
								 <a data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'business'">{{event.creator.businessName}}</a>
							</div>
						</div>
					</div>
					<div class="islet">
						<div class="line">
							<div class="unit full-width last-unit">
								<span class="delta weight--bold">
									<span data-ng-show="event.locationName" class="nudge--right">
										<i class="icon-map-marker muted"></i> <span data-ng-bind="event.locationName"></span> 
									</span>
									<span data-ng-show="event.startDate" class="nudge--right">
										<i class="icon-calendar-empty muted"></i> <span>{{ event.startDate | readableDate }}</span>
									</span>
									<span data-ng-show="event.startTime">
										<i class="icon-time muted"></i> <span data-ng-bind="event.startTime"></span>
									</span>
								</span>
							</div>
						</div>
						<hr />
						<p class="pre-wrap soft-half--ends" data-ng-bind-html="event.description | parseUrl"></p>
					</div>
					<div class="event-footer table full-width soft-quarter--ends">
						<div class="tr">
							<div class="td three-fourths">
								<ul class="tags">
									<li data-ng-repeat="tag in event.tags" data-ng-bind="tag"></li>
								</ul>
							</div>
							<div class="td one-fourth text-right soft-half--right vertical-align-middle">
								<div class="action-buttons nudge-half--right">
									<a class="first" data-ng-class="{green: isAttending(event)}" href data-ng-click="openAttending(event)" data-tooltip="People Attending"><span class="gamma" data-ng-class="{green: isAttending(event)}">{{ event.attending.length }}</span></a>
									<a href data-ng-click="rsvpToEvent(event._id)" data-ng-hide="isAttending(event)"><i class="icon-thumbs-up"></i> RSVP</a>
									<a href data-ng-click="unRsvpToEvent(event._id)" data-ng-show="isAttending(event)"><i class="icon-thumbs-up-alt"></i> Un-RSVP</a>
								</div>
								<div class="action-buttons green">
									<a href data-ng-href="/event/{{event._id}}">Details <i class="icon-chevron-right epsilon"></i></a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div><!-- event end -->
	</div>
</div>

<script type="text/ng-template" id="attendingModal.html">
    <div class="modal-header">
        <h2 class="flush">Attending</h2>
    </div>
    <div class="modal-body">
        <div data-ng-repeat="attendingUser in items" class="user-img-modal nudge-half--right" data-ng-style="{'background-image': 'url(' + attendingUser.pictureUrl + ')'}">
			<a href data-ng-href="profile/{{attendingUser.username}}" data-ng-click="clickLink()" data-ng-show="attendingUser.type == 'student'" data-tooltip="{{attendingUser.firstName}} {{attendingUser.lastName}}" data-tooltip-placement="right"></a>
			<a href data-ng-href="profile/{{attendingUser.username}}" data-ng-click="clickLink()" data-ng-show="attendingUser.type == 'business'" data-tooltip="{{attendingUser.businessName}}" data-tooltip-placement="right"></a>
		</div>
		<div data-ng-hide="items.length">
			<h2 class="flush text-center">No one has RSVPd to this event yet!</h2>
		</div>
    </div>
    <div class="modal-footer">
        <button class="btn" data-ng-click="ok()">Close</button>
    </div>
</script>