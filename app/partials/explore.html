<div class="white-top">
	<div class="container full-height">
		<div class="table full-height full-width">
			<div class="td one-half text-left vertical-align-middle">
				<ng-switch-toggle-group data-theme="candy" data-ng-model="currentView" data-choices="viewOptions"></ng-switch-toggle-group>
			</div>
			<div class="td one-half vertical-align-middle clearfix">
				<div class="input-prepend float-right">
					<div class="icon">
						<i class="icon-search"></i>
					</div>
					<input type="text" class="search" data-ng-model="searchEvents" placeholder="Search events..." />
				</div>
			</div>
		</div>
	</div>
</div>
<div class="table full-width full-height__header" data-ng-show="loading">
	<div class="td full-height full-width vertical-align-middle text-center">
		<div class="box island inline-block text-center">
			<h1 class="flush blue" data-ng-show="loading && !gettingPosition">Loading events...</h1>
			<h1 class="flush blue" data-ng-show="gettingPosition">Getting your location...</h1>
		</div>
	</div>
</div>
<div class="container soft-half--ends" data-ng-show="currentView == 'school'">
	<div class="text-center" data-ng-show="!loading && !events.length">
		<h1 class="flush blue">No events have been posted for your school yet!</h1>
		<a href="/post" class="btn nudge--top">Be the First</a>
	</div>
	<div class="text-center" data-ng-show="!loading && !filteredEvents.length">
		<h2 class="flush blue" data-ng-show="events.length >= 20">No events match your search. Have you tried loading more?</h2>
		<h2 class="flush blue" data-ng-show="events.length < 20">No events match your search.</h2>
	</div>
	<div class="soft-half--ends text-right" data-ng-show="events.length && filteredEvents.length">
		<div class="dropdown">
			<a href class="dropdown-toggle">
				{{ currentSort.label }} <i class="icon-chevron-down muted weight--normal"></i>
			</a>
			<ul class="dropdown-menu pull-right" style="left:none !important;right:0;">
				<li data-ng-repeat="option in sortOptions">
					<a href data-ng-bind="option.label" data-ng-click="changeSort(option)"></a>
				</li>
			</ul>
		</div>
	</div>
	<hr data-ng-show="events.length && filteredEvents.length" />
	<div class="line nudge-half--ends" data-ng-repeat="event in filteredEvents = (events | filter:searchEvents | orderBy:currentSort.value)">
		<div class="unit one-twelfth">
			<div class="user-img-event" data-ng-style="{'background-image': 'url(' + event.creator.pictureUrl + ')'}"}>
				<a href data-tooltip="{{event.creator.businessName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'business'"></a>
				<a href data-tooltip="{{event.creator.firstName}} {{event.creator.lastName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'student'"></a>
			</div>
		</div>
		<div class="unit eleven-twelfths last-unit">
			<div class="box">
				<div class="event-header soft-half--sides">
					<h2 class="flush">
						<i class="zeta icon-unlock nudge-half--right" data-ng-show="event.privacy == 'public'"></i>
						<i class="zeta icon-lock nudge-half--right" data-ng-show="event.privacy == 'inviteonly'"></i>
						{{ event.title }}
					</h2>
					<a data-ng-href="/event/{{event._id}}" class="block-link"></a>
				</div>
				<div class="islet">
					<div class="line">
						<div class="unit four-fifths">
							<span class="delta weight--bold">
								<i class="icon-map-marker muted"></i> <span data-ng-bind="event.locationName"></span> 
								<i class="icon-calendar-empty muted nudge-half--left"></i> <span>{{ event.startDate | readableDate }}</span> 
								<i class="icon-time muted nudge-half--left"></i> <span data-ng-bind="event.startTime"></span>
							</span>
						</div>
						<div class="unit one-fifth last-unit text-right">
							<ul class="tags">
								<li data-ng-repeat="tag in event.tags" data-ng-bind="tag"></li>
							</ul>
						</div>
					</div>
					<p class="pre-wrap" data-ng-bind-html="event.description | parseUrl"></p>
					<div class="line nudge-half--top">
						<div class="unit one-half">
							<div class="action-buttons">
								<a class="first" href data-ng-click="toggleAttending(event._id)" data-tooltip="RSVP" data-ng-hide="isAttending(event._id)"><i class="icon-thumbs-up"></i></a>
								<a class="first" href data-ng-click="toggleAttending(event._id)" data-tooltip="Un-RSVP" data-ng-show="isAttending(event._id)"><i class="icon-thumbs-up green"></i></a>
								<a href data-ng-click="openAttending(event._id)" data-tooltip="People Attending"><span class="gamma">{{ event.attending.length }}</span></a>
							</div>
						</div>
						<div class="unit one-half last-unit text-right">
							<div class="action-buttons green">
								<a href data-ng-href="/event/{{event._id}}">Details <i class="icon-chevron-right epsilon"></i></a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><!-- event end -->
	<hr data-ng-show="events.length >= 20 && filteredEvents.length" />
	<a href data-ng-click="loadMore()" class="btn full-width text-center" data-ng-show="events.length >= 20 && filteredEvents.length">Load More</a>
</div>
<div class="container soft-half--ends" data-ng-show="currentView == 'nearby'">
	<div class="text-center" data-ng-show="!loading && !events">
		<h1 class="flush blue">No events have been posted near you yet!</h1>
		<a href="/post" class="btn nudge--top">Be the First</a>
	</div>
	<div class="text-center" data-ng-show="showLocationError">
		<h1 class="flush blue">We were unable to determine your location</h1>
	</div>
	<div class="soft-half--ends text-right" data-ng-show="events">
		<div class="dropdown">
			<a href class="dropdown-toggle sort-toggle">
				{{ currentSort.label }} <i class="icon-chevron-down muted weight--normal"></i>
			</a>
			<ul class="dropdown-menu pull-right" style="left:none !important;right:0;">
				<li data-ng-repeat="option in sortOptions">
					<a href data-ng-bind="option.label" data-ng-click="changeSort(option)"></a>
				</li>
			</ul>
		</div>
	</div>
	<hr data-ng-show="events" />
	<div class="line nudge-half--ends" data-ng-repeat="event in filteredEvents = (events | filter:searchEvents | orderBy:currentSort.value)">
		<div class="unit one-twelfth">
			<div class="user-img-event" data-ng-style="{'background-image': 'url(' + event.creator.pictureUrl + ')'}"}>
				<a href data-tooltip="{{event.creator.businessName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'business'"></a>
				<a href data-tooltip="{{event.creator.firstName}} {{event.creator.lastName}}" data-tooltip-placement="left" data-ng-href="/profile/{{event.creator.username}}" data-ng-show="event.creator.type == 'student'"></a>
			</div>
		</div>
		<div class="unit eleven-twelfths last-unit">
			<div class="box">
				<div class="event-header soft-half--sides">
					<h2 class="flush">
						<i class="icon-globe nudge-half--right" data-ng-show="event.privacy == 'public'"></i>
						<i class="icon-lock nudge-half--right" data-ng-show="event.privacy == 'inviteonly'"></i>
						{{ event.title }}
					</h2>
					<a data-ng-href="/event/{{event._id}}" class="block-link"></a>
				</div>
				<div class="islet">
					<div class="line">
						<div class="unit four-fifths">
							<span class="delta weight--bold">
								<i class="icon-map-marker muted"></i> <span data-ng-bind="event.locationName"></span> 
								<i class="icon-calendar-empty muted nudge-half--left"></i> <span>{{ event.startDate | readableDate }}</span> 
								<i class="icon-time muted nudge-half--left"></i> <span data-ng-bind="event.startTime"></span>
							</span>
						</div>
						<div class="unit one-fifth last-unit text-right">
							<ul class="tags">
								<li data-ng-repeat="tag in event.tags" data-ng-bind="tag"></li>
							</ul>
						</div>
					</div>
					<p class="pre-wrap" ng-bind-html="event.description | parseUrl"></p>
					<div class="line nudge-half--top">
						<div class="unit one-half">
							<div class="action-buttons">
								<a class="first" href data-ng-click="toggleAttending(event._id)" data-tooltip="RSVP" data-ng-hide="isAttending(event._id)"><i class="icon-thumbs-up"></i></a>
								<a class="first" href data-ng-click="toggleAttending(event._id)" data-tooltip="Un-RSVP" data-ng-show="isAttending(event._id)"><i class="icon-thumbs-up green"></i></a>
								<a href data-ng-click="openAttending(event._id)" data-tooltip="People Attending"><span class="gamma">{{ event.attending.length }}</span></a>
							</div>
						</div>
						<div class="unit one-half last-unit text-right">
							<div class="action-buttons green">
								<a href data-ng-href="/event/{{event._id}}">Details <i class="icon-chevron-right epsilon"></i></a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><!-- event end -->
	<hr data-ng-show="events.length >= 20 && filteredEvents.length" />
	<a href data-ng-click="loadMore()" class="btn full-width text-center" data-ng-show="events.length >= 20 && filteredEvents.length">Load More</a>
</div>

<script type="text/ng-template" id="attendingModal.html">
    <div class="modal-header">
        <h2 class="flush">Attending</h2>
    </div>
    <div class="modal-body">
        <ul>
            <li ng-repeat="item in items">
                <a ng-click="selected.item = item">{{ item }}</a>
            </li>
        </ul>
        Selected: <b>{{ selected.item }}</b>
    </div>
    <div class="modal-footer">
        <button class="btn" data-ng-click="ok()">Close</button>
    </div>
</script>